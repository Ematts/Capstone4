@model Capstone4.Models.ServiceRequest

@{
    ViewBag.Title = "PaymentView";
}

<h2>Pay Contractor</h2>

<div>
    <h4>Service Request</h4>
    <hr />
    <dl class="dl-horizontal">
        @Html.HiddenFor(model => model.ID)
 
        <dt>
            @Html.DisplayNameFor(model => model.Homeowner.Username)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Homeowner.Username)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Contractor.Username)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.Contractor.Username)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Address.Street)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Address.Street)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Address.City)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Address.City)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Address.State)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Address.State)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Address.Zip)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Address.Zip)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Description)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Description)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Price)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Price)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.PostedDate)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.PostedDate)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.CompletionDeadline)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.CompletionDeadline)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.CompletionDate)
        </dt>
        <dd>
            @Html.DisplayFor(model => model.CompletionDate)
        </dd>
        <dt>
            @Html.DisplayNameFor(model => model.Service_Number)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Service_Number)
        </dd>

    </dl>
    <strong>Service Request Photos:</strong>
    <br> <br>

    @foreach (var item in Model.ServiceRequestFilePaths)
    {

        <div class="photocontainer">
            <img class="photo" src="~/images/@item.FileName" alt="Homeowner Photo" width="200" height="133" />
        </div>

    }
    <br> <br>

    <strong>Contractor Photos:</strong>
    <br> <br>

    @foreach (var item in Model.CompletedServiceRequestFilePaths)
    {

        <div class="photocontainer">
            <img class="photo" src="~/images/@item.FileName" alt="Contractor Photo" width="200" height="133" />
        </div>

    }
    <br> <br />
</div>

<script src="https://www.paypalobjects.com/js/external/dg.js" type="text/javascript"></script>
<h2>Make Payment</h2>


@{string service = Model.Description + " Service# = " + Model.Service_Number; }
<form action="https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/pay" target="PPDGFrame" class="standard">
    <label for="buy">Buy Now:</label>
    <input type="image" id="submitBtn" value="Pay with PayPal" src="https://www.paypalobjects.com/en_US/i/btn/btn_paynowCC_LG.gif">
    <input id="type" type="hidden" name="expType" value="light">
    <input id="paykey" type="hidden" name="paykey" value=@ViewData["paykey"]>
</form>
<script type="text/javascript" charset="utf-8">
var embeddedPPFlow = new PAYPAL.apps.DGFlow({ trigger: 'submitBtn' });
</script>
@*}*@
<p>
    @Html.ActionLink("Edit", "Edit", new { id = Model.ID }) |
    @Html.ActionLink("Back to List", "Index")
</p>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        $(function () {
            var showModal = function () {
                var $input = $(this);
                var imgAlt = $input.attr("alt");
                $("#theModal h4.modal-title").html(imgAlt);
                var img = this;
                var imageHeight = $input.height();
                var imagWidth = $input.width();
                var NewimgWidth = imagWidth * 4;
                var NewImgHeight = imageHeight * 4;
                var picSrc = $input.attr("src");
                $("#theModal img").attr('src', picSrc);
                //set new image width
                $("div.modal-dialog").css("width", NewimgWidth);
                $("#theModal img").width(NewimgWidth);
                //set new image height
                $("#theModal img").height(NewImgHeight);
                $("#theModal").modal("show");
            };
            var MyHtml = '<div id="theModal" class="modal fade">' +
                    ' <div class="modal-dialog ">' +
                        '<div class="modal-content">' +
                            ' <div class="modal-header">' +
                                '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>' +
                                '<h4 class="modal-title">Hello!</h4>' +
                             '</div>' +
                            '<div class="modal-body">' +
                               '  <img not-to-enlarge="true" class="img-responsive" + src=""alt="...">' +
                            '</div>' +
                             '<div class="modal-footer">' +
                                 '<button type="button" class="btn btn-default" data-dismiss="modal">' +
                                    'Close' +
                                 '</button>' +
                             '</div>' +
                         '</div>' +
                     '</div>' +
                 '</div>';
            $("div.body-content").append(MyHtml);
            $("img[not-to-enlarge!=true]").click(showModal);
            $("img[not-to-enlarge!=true]").css("cursor", "pointer");
        });
    </script>
}
